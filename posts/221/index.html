<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>记一次博客迁移记录 | Zs's Blog</title><meta name=keywords content="杂谈"><meta name=description content="前言 更换博客系统的想法已经萌生很久了，一个是感觉 Handsome 这个主题有点看腻了，但是在 Typecho 中好似已经没有更好的博客主题可选择了。
有一个看起来貌似很不错，主题名叫 maupassant。效果如下图所示，顺附链接
pagecho/maupassant(github.com)
不过一直没有下定决心更换，后来也尝试过使用 WordPress，又觉得 WordPress 体量有点太大了。
每天逛 Github 的时候看到了很多很不错的静态博客主题，那天看到一个学长分析学校校园网的博客，第一眼就感觉很不错，找寻了一下发现博客基于 Hugo，主题是 hugo-PaperMod。
于是顺着寻找了一下，发现 Hugo 中很多博客主题非常的不错。此外，Hugo 相比于 Hexo 也有很多优点：博客构建速度快，基于模板的概念组织内容，环境配置容易，在 Ubuntu 下一行命令即可，而 Hexo 依赖于 Node.js，体量稍微有点大。
于是决定把博客迁移到 Hugo，并且采用主题 Coder 。
过程 Typecho 文章导出 这里采用了 lizheming 大大的迁移插件：lizheming/typecho-export-hugo
具体导出为 zip 的时候可能会提示损坏，这样的话可以直接去服务器 \tmp\Export2Hugo 下面打包。
安装 hugo 过程基于 Windows 平台，很简单，在 这里 下载 hugo 最新的 release 版本，找到对应自己系统的即可。下载后解压到某个目录下，设置一下环境变量即可。这里牵扯到 hugo 和 hugo_extended 两个版本的区别，以下是某个 issue 中的解释：
I agree.
The only functional difference is SASS/SCSS The technical build time difference is that it requires a C++ build chain for the target platform to build, the reason why we currently only build the extended for 3 platforms (Windows, Linux, MacOS) Binaries are slightly less portable as you need a compatible Libc version on your computer (for Windows we build a fully static version as Libc is rather uncommon unless you have Visual Studio or something installed)."><meta name=author content="zzsqwq"><link rel=canonical href=https://blog.zzsqwq.cn/posts/221/><meta name=google-site-verification content="G-WF7TH97J9X"><link crossorigin=anonymous href=/assets/css/stylesheet.0c4fd3725171366f335155acde6fb3c7b7042cd2fd075bebf5023d9b28a701b2.css integrity="sha256-DE/TclFxNm8zUVWs3m+zx7cELNL9B1vr9QI9myinAbI=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.zzsqwq.cn/images/avatar.png><link rel=icon type=image/png sizes=16x16 href=https://blog.zzsqwq.cn/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.zzsqwq.cn/images/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.zzsqwq.cn/apple-touch-icon.png><link rel=mask-icon href=https://blog.zzsqwq.cn/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-WF7TH97J9X"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-WF7TH97J9X",{anonymize_ip:!1})}</script><meta property="og:title" content="记一次博客迁移记录"><meta property="og:description" content="前言 更换博客系统的想法已经萌生很久了，一个是感觉 Handsome 这个主题有点看腻了，但是在 Typecho 中好似已经没有更好的博客主题可选择了。
有一个看起来貌似很不错，主题名叫 maupassant。效果如下图所示，顺附链接
pagecho/maupassant(github.com)
不过一直没有下定决心更换，后来也尝试过使用 WordPress，又觉得 WordPress 体量有点太大了。
每天逛 Github 的时候看到了很多很不错的静态博客主题，那天看到一个学长分析学校校园网的博客，第一眼就感觉很不错，找寻了一下发现博客基于 Hugo，主题是 hugo-PaperMod。
于是顺着寻找了一下，发现 Hugo 中很多博客主题非常的不错。此外，Hugo 相比于 Hexo 也有很多优点：博客构建速度快，基于模板的概念组织内容，环境配置容易，在 Ubuntu 下一行命令即可，而 Hexo 依赖于 Node.js，体量稍微有点大。
于是决定把博客迁移到 Hugo，并且采用主题 Coder 。
过程 Typecho 文章导出 这里采用了 lizheming 大大的迁移插件：lizheming/typecho-export-hugo
具体导出为 zip 的时候可能会提示损坏，这样的话可以直接去服务器 \tmp\Export2Hugo 下面打包。
安装 hugo 过程基于 Windows 平台，很简单，在 这里 下载 hugo 最新的 release 版本，找到对应自己系统的即可。下载后解压到某个目录下，设置一下环境变量即可。这里牵扯到 hugo 和 hugo_extended 两个版本的区别，以下是某个 issue 中的解释：
I agree.
The only functional difference is SASS/SCSS The technical build time difference is that it requires a C++ build chain for the target platform to build, the reason why we currently only build the extended for 3 platforms (Windows, Linux, MacOS) Binaries are slightly less portable as you need a compatible Libc version on your computer (for Windows we build a fully static version as Libc is rather uncommon unless you have Visual Studio or something installed)."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.zzsqwq.cn/posts/221/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-12-13T02:59:00+00:00"><meta property="article:modified_time" content="2021-12-13T02:59:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="记一次博客迁移记录"><meta name=twitter:description content="前言 更换博客系统的想法已经萌生很久了，一个是感觉 Handsome 这个主题有点看腻了，但是在 Typecho 中好似已经没有更好的博客主题可选择了。
有一个看起来貌似很不错，主题名叫 maupassant。效果如下图所示，顺附链接
pagecho/maupassant(github.com)
不过一直没有下定决心更换，后来也尝试过使用 WordPress，又觉得 WordPress 体量有点太大了。
每天逛 Github 的时候看到了很多很不错的静态博客主题，那天看到一个学长分析学校校园网的博客，第一眼就感觉很不错，找寻了一下发现博客基于 Hugo，主题是 hugo-PaperMod。
于是顺着寻找了一下，发现 Hugo 中很多博客主题非常的不错。此外，Hugo 相比于 Hexo 也有很多优点：博客构建速度快，基于模板的概念组织内容，环境配置容易，在 Ubuntu 下一行命令即可，而 Hexo 依赖于 Node.js，体量稍微有点大。
于是决定把博客迁移到 Hugo，并且采用主题 Coder 。
过程 Typecho 文章导出 这里采用了 lizheming 大大的迁移插件：lizheming/typecho-export-hugo
具体导出为 zip 的时候可能会提示损坏，这样的话可以直接去服务器 \tmp\Export2Hugo 下面打包。
安装 hugo 过程基于 Windows 平台，很简单，在 这里 下载 hugo 最新的 release 版本，找到对应自己系统的即可。下载后解压到某个目录下，设置一下环境变量即可。这里牵扯到 hugo 和 hugo_extended 两个版本的区别，以下是某个 issue 中的解释：
I agree.
The only functional difference is SASS/SCSS The technical build time difference is that it requires a C++ build chain for the target platform to build, the reason why we currently only build the extended for 3 platforms (Windows, Linux, MacOS) Binaries are slightly less portable as you need a compatible Libc version on your computer (for Windows we build a fully static version as Libc is rather uncommon unless you have Visual Studio or something installed)."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://blog.zzsqwq.cn/posts/"},{"@type":"ListItem","position":3,"name":"记一次博客迁移记录","item":"https://blog.zzsqwq.cn/posts/221/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"记一次博客迁移记录","name":"记一次博客迁移记录","description":"前言 更换博客系统的想法已经萌生很久了，一个是感觉 Handsome 这个主题有点看腻了，但是在 Typecho 中好似已经没有更好的博客主题可选择了。\n有一个看起来貌似很不错，主题名叫 maupassant。效果如下图所示，顺附链接\npagecho/maupassant(github.com)\n不过一直没有下定决心更换，后来也尝试过使用 WordPress，又觉得 WordPress 体量有点太大了。\n每天逛 Github 的时候看到了很多很不错的静态博客主题，那天看到一个学长分析学校校园网的博客，第一眼就感觉很不错，找寻了一下发现博客基于 Hugo，主题是 hugo-PaperMod。\n于是顺着寻找了一下，发现 Hugo 中很多博客主题非常的不错。此外，Hugo 相比于 Hexo 也有很多优点：博客构建速度快，基于模板的概念组织内容，环境配置容易，在 Ubuntu 下一行命令即可，而 Hexo 依赖于 Node.js，体量稍微有点大。\n于是决定把博客迁移到 Hugo，并且采用主题 Coder 。\n过程 Typecho 文章导出 这里采用了 lizheming 大大的迁移插件：lizheming/typecho-export-hugo\n具体导出为 zip 的时候可能会提示损坏，这样的话可以直接去服务器 \\tmp\\Export2Hugo 下面打包。\n安装 hugo 过程基于 Windows 平台，很简单，在 这里 下载 hugo 最新的 release 版本，找到对应自己系统的即可。下载后解压到某个目录下，设置一下环境变量即可。这里牵扯到 hugo 和 hugo_extended 两个版本的区别，以下是某个 issue 中的解释：\nI agree.\nThe only functional difference is SASS/SCSS The technical build time difference is that it requires a C++ build chain for the target platform to build, the reason why we currently only build the extended for 3 platforms (Windows, Linux, MacOS) Binaries are slightly less portable as you need a compatible Libc version on your computer (for Windows we build a fully static version as Libc is rather uncommon unless you have Visual Studio or something installed).","keywords":["杂谈"],"articleBody":"前言 更换博客系统的想法已经萌生很久了，一个是感觉 Handsome 这个主题有点看腻了，但是在 Typecho 中好似已经没有更好的博客主题可选择了。\n有一个看起来貌似很不错，主题名叫 maupassant。效果如下图所示，顺附链接\npagecho/maupassant(github.com)\n不过一直没有下定决心更换，后来也尝试过使用 WordPress，又觉得 WordPress 体量有点太大了。\n每天逛 Github 的时候看到了很多很不错的静态博客主题，那天看到一个学长分析学校校园网的博客，第一眼就感觉很不错，找寻了一下发现博客基于 Hugo，主题是 hugo-PaperMod。\n于是顺着寻找了一下，发现 Hugo 中很多博客主题非常的不错。此外，Hugo 相比于 Hexo 也有很多优点：博客构建速度快，基于模板的概念组织内容，环境配置容易，在 Ubuntu 下一行命令即可，而 Hexo 依赖于 Node.js，体量稍微有点大。\n于是决定把博客迁移到 Hugo，并且采用主题 Coder 。\n过程 Typecho 文章导出 这里采用了 lizheming 大大的迁移插件：lizheming/typecho-export-hugo\n具体导出为 zip 的时候可能会提示损坏，这样的话可以直接去服务器 \\tmp\\Export2Hugo 下面打包。\n安装 hugo 过程基于 Windows 平台，很简单，在 这里 下载 hugo 最新的 release 版本，找到对应自己系统的即可。下载后解压到某个目录下，设置一下环境变量即可。这里牵扯到 hugo 和 hugo_extended 两个版本的区别，以下是某个 issue 中的解释：\nI agree.\nThe only functional difference is SASS/SCSS The technical build time difference is that it requires a C++ build chain for the target platform to build, the reason why we currently only build the extended for 3 platforms (Windows, Linux, MacOS) Binaries are slightly less portable as you need a compatible Libc version on your computer (for Windows we build a fully static version as Libc is rather uncommon unless you have Visual Studio or something installed). via: Please document the difference between the “extended” and non-“extended” versions\n我认为，直接使用 extended 版本就完事了。使用了 extended 不会报错，而不用 extended 版本可能会报错。\n构建网站 首先在合适的目录下生成一个新的网站\n$ hugo new site zsblog 然后进入目录后，初始化一个 git 仓库\n$ git init [可选]将自己心仪的目录设置为 git 的 submodule ，需要注意的是，hugo 中的主题配置多是基于 submodule 的，这种方式很灵活，也便于更新，当然，需要先学习一下 submodule 的用法:) ，这里以 coder 主题为例：\n$ git submodule add https://github.com/luizdepra/hugo-coder.git themes/hugo-coder 然后基于对应主题的 exampleSite 来设定对应的配置文件 config.toml，这里很蛋疼的是 coder 主题居然偏爱 toml 配置格式，为什么不是 yaml/json 呢？\n补充：hugo 支持三种格式的配置文件 yaml, toml, json.\n然后启动博客即可\n$ hugo server 这里很有意思的是，启动多个 server 不会冲突，hugo 会选择另外一个端口部署。同时，启动 server 不会显式生成静态文件。\n最后就是上传到 Github，然后可以选用 Github Pages 进行部署，注意 Baseurl 的设定。\n利用 Github Actions 进行持续部署 我这里采用的是将我的博客部署到我的服务器，使用 Github Actions 进行 CI/CD。\n使用了 actions/checkout@v2、peaceiris/actions-hugo@v2、peaceiris/actions-gh-pages、burnett01/rsync-deployments@5.1 这几个模板，向大佬表示感谢！\n其中有一个很坑的地方是之前用的 rsync 模板是 contention/rsync-deployments，不知道是为啥···我用这个的时候，只要使用 --exclude 参数他就犯病，显示成功但是却没有上传到云端服务器，搁那里 debug 了半天发现是插件好像有点 bug ？有点麻了..\n具体的配置文件如下：\nname: Zs-Hugo-Blog on: push: branches: - master # Set a branch to deploy pull_request: jobs: deploy: runs-on: ubuntu-20.04 concurrency: group: ${{ github.workflow }}-${{ github.ref }} steps: - uses: actions/checkout@v2 with: submodules: true # Fetch Hugo themes (true OR recursive) fetch-depth: 0 # Fetch all history for .GitInfo and .Lastmod - name: Setup Hugo uses: peaceiris/actions-hugo@v2 with: hugo-version: 'latest' extended: true - name: Build run: hugo --minify - name: Deploy uses: peaceiris/actions-gh-pages@v3 if: ${{ github.ref == 'refs/heads/master' }} with: github_token: ${{ secrets.HUGO_DEPLOY }} publish_dir: ./public - uses: actions/checkout@v2 with: ref: 'gh-pages' - name: rsync deployments uses: burnett01/rsync-deployments@5.1 with: switches: -avzr --delete --exclude=\".htaccess\" --exclude=\"/usr/\" path: ./ remote_path: /www/wwwroot/new_blog/ remote_host: zzsqwq.cn remote_user: www remote_key: ${{ secrets.SSH_KEY }} 一些其他配置 再者我还配置了 Google analytics，hugo 对 Google analytics 的支持很不错，点击 这里 查看详情。\n此外还有配置了基于 Utterances 的评论系统，起初想要尝试使用 Commento 的，自己搭建了个服务，搞了半天也没搞好，无法在我的网站正常加载，最后还是采用了 Utterances，几分钟就搞好了，可恶。\n同时，为了保持原先博客的链接活性，我将原博客部署到了 https://lastblog.zzsqwq.cn ，在 Apache 中将原博客链接全部重定向到当前网站，这样就不会产生死链了，配置如下：\n#rewrite RewriteEngine On RewriteRule ^/?index.php/(.*)$ https://lastblog.zzsqwq.cn/index.php/$1 [R,L] 后记 其中还有一些 RSS 的配置、评论系统宽度的修改等一些小问题，就不细说了。\n有个比较蛋疼的问题就是目前 Utterances 评论系统的配色不能随着博客亮暗的切换改变，后续计划改善一下\n同时，为了保持主题的可配置性，我 fork 了一份主题，并且针对做了一些修改，仓库地址：zzsqwq/hugo-coder\n","wordCount":"396","inLanguage":"en","datePublished":"2021-12-13T02:59:00Z","dateModified":"2021-12-13T02:59:00Z","author":{"@type":"Person","name":"zzsqwq"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.zzsqwq.cn/posts/221/"},"publisher":{"@type":"Organization","name":"Zs's Blog","logo":{"@type":"ImageObject","url":"https://blog.zzsqwq.cn/images/avatar.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.zzsqwq.cn accesskey=h title="Zs's Blog (Alt + H)">Zs's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://blog.zzsqwq.cn/about title=About><span>About</span></a></li><li><a href=https://blog.zzsqwq.cn/posts title=Posts><span>Posts</span></a></li><li><a href=https://blog.zzsqwq.cn/friends title=Friends><span>Friends</span></a></li><li><a href=https://blog.zzsqwq.cn/contact title=Contact><span>Contact</span></a></li><li><a href=https://blog.zzsqwq.cn/search title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.zzsqwq.cn>Home</a>&nbsp;»&nbsp;<a href=https://blog.zzsqwq.cn/posts/>Posts</a></div><h1 class=post-title>记一次博客迁移记录</h1><div class=post-meta><span title='2021-12-13 02:59:00 +0000 UTC'>December 13, 2021</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;zzsqwq&nbsp;|&nbsp;<a href=https://github.com/zzsqwq/zzsqwq.github.io/tree/master/content/posts/blog_migrate.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e5%89%8d%e8%a8%80 aria-label=前言>前言</a></li><li><a href=#%e8%bf%87%e7%a8%8b aria-label=过程>过程</a><ul><li><a href=#typecho-%e6%96%87%e7%ab%a0%e5%af%bc%e5%87%ba aria-label="Typecho 文章导出">Typecho 文章导出</a></li><li><a href=#%e5%ae%89%e8%a3%85-hugo aria-label="安装 hugo">安装 hugo</a></li><li><a href=#%e6%9e%84%e5%bb%ba%e7%bd%91%e7%ab%99 aria-label=构建网站>构建网站</a></li><li><a href=#%e5%88%a9%e7%94%a8-github-actions-%e8%bf%9b%e8%a1%8c%e6%8c%81%e7%bb%ad%e9%83%a8%e7%bd%b2 aria-label="利用 Github Actions 进行持续部署">利用 Github Actions 进行持续部署</a></li><li><a href=#%e4%b8%80%e4%ba%9b%e5%85%b6%e4%bb%96%e9%85%8d%e7%bd%ae aria-label=一些其他配置>一些其他配置</a></li></ul></li><li><a href=#%e5%90%8e%e8%ae%b0 aria-label=后记>后记</a></li></ul></div></details></div><div class=post-content><h2 id=前言>前言<a hidden class=anchor aria-hidden=true href=#前言>#</a></h2><p>更换博客系统的想法已经萌生很久了，一个是感觉 Handsome 这个主题有点看腻了，但是在 Typecho 中好似已经没有更好的博客主题可选择了。</p><p>有一个看起来貌似很不错，主题名叫 maupassant。效果如下图所示，顺附链接</p><p><a href=https://github.com/pagecho/maupassant>pagecho/maupassant(github.com)</a></p><p><img loading=lazy src=https://camo.githubusercontent.com/6f925dcec164e50cad950577db00910d3821d388e3f018d4b7d900cc2ce081c0/68747470733a2f2f6464796465672e6279333330322e6c69766566696c6573746f72652e636f6d2f793270315a67484552346549466145486877616639364d765a48345f694c75664549446a376f38616344674931475846447450492d65524167766f6b466f52396972627a373338674d6d57635f4e3779657847367568423144636d656c623063586738486578706941645a3548512f6d2e706e67 alt=maupassant></p><p>不过一直没有下定决心更换，后来也尝试过使用 WordPress，又觉得 WordPress 体量有点太大了。</p><p>每天逛 Github 的时候看到了很多很不错的静态博客主题，那天看到一个学长<a href=https://zincnode.com/posts/campusnetwork/>分析学校校园网的博客</a>，第一眼就感觉很不错，找寻了一下发现博客基于 <a href=https://gohugo.io/>Hugo</a>，主题是 <a href=https://github.com/adityatelange/hugo-PaperMod>hugo-PaperMod</a>。</p><p>于是顺着寻找了一下，发现 Hugo 中很多博客主题非常的不错。此外，Hugo 相比于 Hexo 也有很多优点：博客构建速度快，基于模板的概念组织内容，环境配置容易，在 Ubuntu 下一行命令即可，而 Hexo 依赖于 Node.js，体量稍微有点大。</p><p>于是决定把博客迁移到 Hugo，并且采用主题 <a href=https://github.com/luizdepra/hugo-coder>Coder</a> 。</p><h2 id=过程>过程<a hidden class=anchor aria-hidden=true href=#过程>#</a></h2><h3 id=typecho-文章导出>Typecho 文章导出<a hidden class=anchor aria-hidden=true href=#typecho-文章导出>#</a></h3><p>这里采用了 lizheming 大大的迁移插件：<a href=https://github.com/lizheming/typecho-export-hugo>lizheming/typecho-export-hugo</a></p><p><strong>具体导出为 zip 的时候可能会提示损坏，这样的话可以直接去服务器 <code>\tmp\Export2Hugo</code> 下面打包。</strong></p><h3 id=安装-hugo>安装 hugo<a hidden class=anchor aria-hidden=true href=#安装-hugo>#</a></h3><p>过程基于 Windows 平台，很简单，在 <a href=https://github.com/gohugoio/hugo/releases/tag/v0.90.1>这里</a> 下载 hugo 最新的 release 版本，找到对应自己系统的即可。下载后解压到某个目录下，设置一下环境变量即可。这里牵扯到 hugo 和 hugo_extended 两个版本的区别，以下是某个 issue 中的解释：</p><blockquote><p>I agree.</p><ul><li>The only functional difference is SASS/SCSS</li><li>The technical build time difference is that it requires a C++ build chain for the target platform to build, the reason why we currently only build the extended for 3 platforms (Windows, Linux, MacOS)</li><li>Binaries are slightly less portable as you need a compatible Libc version on your computer (for Windows we build a fully static version as Libc is rather uncommon unless you have Visual Studio or something installed).</li></ul><p>via: <a href=https://github.com/gohugoio/hugoDocs/issues/1152>Please document the difference between the &ldquo;extended&rdquo; and non-&ldquo;extended&rdquo; versions</a></p></blockquote><p>我认为，直接使用 extended 版本就完事了。使用了 extended 不会报错，而不用 extended 版本可能会报错。</p><h3 id=构建网站>构建网站<a hidden class=anchor aria-hidden=true href=#构建网站>#</a></h3><p>首先在合适的目录下生成一个新的网站</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ hugo new site zsblog
</span></span></code></pre></div><p>然后进入目录后，初始化一个 git 仓库</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ git init
</span></span></code></pre></div><p>[可选]将自己心仪的目录设置为 git 的 <a href=https://git-scm.com/book/en/v2/Git-Tools-Submodules>submodule</a> ，需要注意的是，hugo 中的主题配置多是基于 submodule 的，这种方式很灵活，也便于更新，当然，需要先学习一下 submodule 的用法:) ，这里以 coder 主题为例：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ git submodule add https://github.com/luizdepra/hugo-coder.git themes/hugo-coder
</span></span></code></pre></div><p>然后基于对应主题的 exampleSite 来设定对应的配置文件 config.toml，<strong>这里很蛋疼的是 coder 主题居然偏爱 toml 配置格式，为什么不是 yaml/json 呢？</strong></p><blockquote><p>补充：hugo 支持三种格式的配置文件 yaml, toml, json.</p></blockquote><p>然后启动博客即可</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ hugo server
</span></span></code></pre></div><p>这里很有意思的是，启动多个 server 不会冲突，hugo 会选择另外一个端口部署。同时，启动 server 不会显式生成静态文件。</p><p>最后就是上传到 Github，然后可以选用 Github Pages 进行部署，<strong>注意 Baseurl 的设定</strong>。</p><h3 id=利用-github-actions-进行持续部署>利用 Github Actions 进行持续部署<a hidden class=anchor aria-hidden=true href=#利用-github-actions-进行持续部署>#</a></h3><p>我这里采用的是将我的博客部署到我的服务器，使用 Github Actions 进行 CI/CD。</p><p>使用了 <a href=https://github.com/actions/checkout>actions/checkout@v2</a>、<a href=https://github.com/peaceiris/actions-hugo>peaceiris/actions-hugo@v2</a>、<a href=https://github.com/peaceiris/actions-gh-pages>peaceiris/actions-gh-pages</a>、<a href=https://github.com/Burnett01/rsync-deployments>burnett01/rsync-deployments@5.1</a> 这几个模板，向大佬表示感谢！</p><p>其中有一个很坑的地方是之前用的 rsync 模板是 <a href=https://github.com/contention/rsync-deployments>contention/rsync-deployments</a>，不知道是为啥···我用这个的时候，只要使用 <code>--exclude</code> 参数他就犯病，显示成功但是却没有上传到云端服务器，搁那里 debug 了半天发现是插件好像有点 bug ？有点麻了..</p><p>具体的配置文件如下：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Zs-Hugo-Blog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>on</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>push</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>branches</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>master </span><span class=w> </span><span class=c># Set a branch to deploy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pull_request</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>jobs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>deploy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class=l>ubuntu-20.04</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>concurrency</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>group</span><span class=p>:</span><span class=w> </span><span class=l>${{ github.workflow }}-${{ github.ref }}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/checkout@v2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>submodules</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>  </span><span class=c># Fetch Hugo themes (true OR recursive)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>fetch-depth</span><span class=p>:</span><span class=w> </span><span class=m>0</span><span class=w>    </span><span class=c># Fetch all history for .GitInfo and .Lastmod</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Setup Hugo</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>peaceiris/actions-hugo@v2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>hugo-version</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;latest&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>extended</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Build</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>hugo --minify</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Deploy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>peaceiris/actions-gh-pages@v3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>${{ github.ref == &#39;refs/heads/master&#39; }}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>github_token</span><span class=p>:</span><span class=w> </span><span class=l>${{ secrets.HUGO_DEPLOY }}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>publish_dir</span><span class=p>:</span><span class=w> </span><span class=l>./public</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/checkout@v2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>ref</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;gh-pages&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>rsync deployments</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>burnett01/rsync-deployments@5.1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>switches</span><span class=p>:</span><span class=w> </span>-<span class=l>avzr --delete --exclude=&#34;.htaccess&#34; --exclude=&#34;/usr/&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>./</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>remote_path</span><span class=p>:</span><span class=w> </span><span class=l>/www/wwwroot/new_blog/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>remote_host</span><span class=p>:</span><span class=w> </span><span class=l>zzsqwq.cn</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>remote_user</span><span class=p>:</span><span class=w> </span><span class=l>www</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>remote_key</span><span class=p>:</span><span class=w> </span><span class=l>${{ secrets.SSH_KEY }}</span><span class=w>
</span></span></span></code></pre></div><h3 id=一些其他配置>一些其他配置<a hidden class=anchor aria-hidden=true href=#一些其他配置>#</a></h3><p>再者我还配置了 <a href=https://analytics.google.com/analytics/web/#/>Google analytics</a>，hugo 对 Google analytics 的支持很不错，点击 <a href=https://gohugo.io/templates/internal/#configure-google-analytics>这里</a> 查看详情。</p><p>此外还有配置了基于 Utterances 的评论系统，起初想要尝试使用 Commento 的，自己搭建了个服务，搞了半天也没搞好，无法在我的网站正常加载，最后还是采用了 Utterances，几分钟就搞好了，可恶。</p><p>同时，为了保持原先博客的链接活性，我将原博客部署到了 <a href=https://lastblog.zzsqwq.cn>https://lastblog.zzsqwq.cn</a> ，在 Apache 中将原博客链接全部重定向到当前网站，这样就不会产生死链了，配置如下：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1>#rewrite</span>
</span></span><span class=line><span class=cl>RewriteEngine On
</span></span><span class=line><span class=cl>RewriteRule ^/?index.php/<span class=o>(</span>.*<span class=o>)</span>$ https://lastblog.zzsqwq.cn/index.php/<span class=nv>$1</span> <span class=o>[</span>R,L<span class=o>]</span>
</span></span></code></pre></div><h2 id=后记>后记<a hidden class=anchor aria-hidden=true href=#后记>#</a></h2><p>其中还有一些 RSS 的配置、评论系统宽度的修改等一些小问题，就不细说了。</p><p>有个比较蛋疼的问题就是目前 Utterances 评论系统的配色不能随着博客亮暗的切换改变，后续计划改善一下</p><p>同时，为了保持主题的可配置性，我 fork 了一份主题，并且针对做了一些修改，仓库地址：<a href=https://github.com/zzsqwq/hugo-coder>zzsqwq/hugo-coder</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.zzsqwq.cn/tags/%E6%9D%82%E8%B0%88/>杂谈</a></li></ul><nav class=paginav><a class=prev href=https://blog.zzsqwq.cn/posts/223/><span class=title>« Prev</span><br><span>一个 Javascript 中异步的小技巧</span></a>
<a class=next href=https://blog.zzsqwq.cn/posts/220/><span class=title>Next »</span><br><span>Markdown 编辑器推荐</span></a></nav></footer><div class=comments><script>let getTheme=window.localStorage&&window.localStorage.getItem("colorscheme");getTheme=getTheme??"preferred_color_scheme";let s=document.createElement("script");s.src="https://giscus.app/client.js",s.setAttribute("data-repo","zzsqwq/hugo-blog-comment"),s.setAttribute("data-repo-id","R_kgDOGgU1qQ"),s.setAttribute("data-category","DIC_kwDOGgU1qc4CSX1m"),s.setAttribute("data-category-id",""),s.setAttribute("data-mapping","pathname"),s.setAttribute("data-strict","0"),s.setAttribute("data-reactions-enabled","1"),s.setAttribute("data-emit-metadata","0"),s.setAttribute("data-input-position","top"),s.setAttribute("data-theme",getTheme),s.setAttribute("data-lang",""),s.setAttribute("crossorigin","anonymous"),s.setAttribute("async",""),document.querySelector("div.comments").innerHTML="",document.querySelector("div.comments").appendChild(s)</script></div></article></main><footer class=footer><span>&copy; 2023 <a href=https://blog.zzsqwq.cn>Zs's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>