<!doctype html><html lang=cn>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=content-language content="cn">
<meta name=color-scheme content="light dark">
<meta http-equiv=content-security-policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net/; form-action 'self'; frame-src 'self'; img-src 'self'; object-src 'none'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com/ https://cdn.jsdelivr.net/; script-src 'self' 'unsafe-inline' https://www.google-analytics.com; prefetch-src 'self'; connect-src 'self' https://www.google-analytics.com;">
<meta name=author content="zzsqwq">
<meta name=description content="
  C++大数类设计思路
  
    
  


  洛谷大数类的评测结果(开了氧气优化)
  
    
  


这个第四个点真的优化不过去了QAQ，24W的数据，丧心病狂">
<meta name=keywords content="blog,developer,personal">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="C++大数类的实现">
<meta name=twitter:description content="
  C++大数类设计思路
  
    
  


  洛谷大数类的评测结果(开了氧气优化)
  
    
  


这个第四个点真的优化不过去了QAQ，24W的数据，丧心病狂">
<meta property="og:title" content="C++大数类的实现">
<meta property="og:description" content="
  C++大数类设计思路
  
    
  


  洛谷大数类的评测结果(开了氧气优化)
  
    
  


这个第四个点真的优化不过去了QAQ，24W的数据，丧心病狂">
<meta property="og:type" content="article">
<meta property="og:url" content="https://zzsqwq.github.io/Zs-Hugo-Blog/posts/64/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2020-04-06T01:22:00+00:00">
<meta property="article:modified_time" content="2020-04-06T01:22:00+00:00">
<title>
C++大数类的实现 · Zs's Blog
</title>
<link rel=canonical href=https://zzsqwq.github.io/Zs-Hugo-Blog/posts/64/>
<link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin>
<link rel=stylesheet href=/Zs-Hugo-Blog/css/coder.min.d9fddbffe6f27e69985dc5fe0471cdb0e57fbf4775714bc3d847accb08f4a1f6.css integrity="sha256-2f3b/+byfmmYXcX+BHHNsOV/v0d1cUvD2Eesywj0ofY=" crossorigin=anonymous media=screen>
<link rel=stylesheet href=/Zs-Hugo-Blog/css/coder-dark.min.ccbbada2e264e4fdbf9b2181cccc2cdb289a63dc9520a1e96ac2b9a45778df29.css integrity="sha256-zLutouJk5P2/myGBzMws2yiaY9yVIKHpasK5pFd43yk=" crossorigin=anonymous media=screen>
<link rel=icon type=image/png href=/Zs-Hugo-Blog/images/favicon-32x32.png sizes=32x32>
<link rel=icon type=image/png href=/Zs-Hugo-Blog/images/favicon-16x16.png sizes=16x16>
<link rel=apple-touch-icon href=/Zs-Hugo-Blog/images/apple-touch-icon.png>
<link rel=apple-touch-icon sizes=180x180 href=/Zs-Hugo-Blog/images/apple-touch-icon.png>
<meta name=generator content="Hugo 0.89.4">
</head>
<body class="preload-transitions colorscheme-auto">
<div class=float-container>
<a id=dark-mode-toggle class=colorscheme-toggle>
<i class="fa fa-adjust fa-fw" aria-hidden=true></i>
</a>
</div>
<main class=wrapper>
<nav class=navigation>
<section class=container>
<a class=navigation-title href=/Zs-Hugo-Blog>
Zs's Blog
</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle>
<i class="fa fa-bars fa-fw" aria-hidden=true></i>
</label>
<ul class=navigation-list>
<li class=navigation-item>
<a class=navigation-link href=/Zs-Hugo-Blog/about/>About</a>
</li>
<li class=navigation-item>
<a class=navigation-link href=/Zs-Hugo-Blog/posts/>Blog</a>
</li>
<li class=navigation-item>
<a class=navigation-link href=/Zs-Hugo-Blog/projects/>Projects</a>
</li>
<li class=navigation-item>
<a class=navigation-link href=/Zs-Hugo-Blog/contact/>Contact me</a>
</li>
</ul>
</section>
</nav>
<div class=content>
<section class="container post">
<article>
<header>
<div class=post-title>
<h1 class=title>
<a class=title-link href=https://zzsqwq.github.io/Zs-Hugo-Blog/posts/64/>
C++大数类的实现
</a>
</h1>
</div>
<div class=post-meta>
<div class=date>
<span class=posted-on>
<i class="fa fa-calendar" aria-hidden=true></i>
<time datetime=2020-04-06T01:22:00Z>
April 6, 2020
</time>
</span>
<span class=reading-time>
<i class="fa fa-clock-o" aria-hidden=true></i>
</span>
</div>
<div class=categories>
<i class="fa fa-folder" aria-hidden=true></i>
<a href=/Zs-Hugo-Blog/categories/c++/>C++</a></div>
<div class=tags>
<i class="fa fa-tag" aria-hidden=true></i>
<span class=tag>
<a href=/Zs-Hugo-Blog/tags/c++/>C++</a>
</span>
<span class=separator>•</span>
<span class=tag>
<a href=/Zs-Hugo-Blog/tags/%E5%A4%A7%E6%95%B0%E7%B1%BB/>大数类</a>
</span></div>
</div>
</header>
<div>
<h1 id=c大数类设计思路>
C++大数类设计思路
<a class=heading-link href=#c%e5%a4%a7%e6%95%b0%e7%b1%bb%e8%ae%be%e8%ae%a1%e6%80%9d%e8%b7%af>
<i class="fa fa-link" aria-hidden=true></i>
</a>
</h1>
<h3 id=洛谷大数类httpswwwluogucomcnproblemu111551的评测结果开了氧气优化>
<a href=https://www.luogu.com.cn/problem/U111551>洛谷大数类</a>的评测结果(开了氧气优化)
<a class=heading-link href=#%e6%b4%9b%e8%b0%b7%e5%a4%a7%e6%95%b0%e7%b1%bbhttpswwwluogucomcnproblemu111551%e7%9a%84%e8%af%84%e6%b5%8b%e7%bb%93%e6%9e%9c%e5%bc%80%e4%ba%86%e6%b0%a7%e6%b0%94%e4%bc%98%e5%8c%96>
<i class="fa fa-link" aria-hidden=true></i>
</a>
</h3>
<p><img src=https://www.zzsqwq.cn/usr/uploads/2020/08/4200651250.png alt=BigNumber.png></p>
<p><strong>这个第四个点真的优化不过去了QAQ，24W的数据，<del>丧心病狂</del></strong></p>
<h3 id=整体构思>
整体构思
<a class=heading-link href=#%e6%95%b4%e4%bd%93%e6%9e%84%e6%80%9d>
<i class="fa fa-link" aria-hidden=true></i>
</a>
</h3>
<p>​    构造大数类名为 <strong>BigNumber</strong> ,首先想法是用字符串读入大数，然后将其转化为vector数组倒序分位存储的整数，然后通过一个 <strong>len</strong> 来记录数字的位数，便于做运算。还设计了一个标记变量，用于标记这数为正数还是负数。</p>
<h3 id=构造函数>
构造函数
<a class=heading-link href=#%e6%9e%84%e9%80%a0%e5%87%bd%e6%95%b0>
<i class="fa fa-link" aria-hidden=true></i>
</a>
</h3>
<p>​    我用了两种构造函数，一个是无参构造函数，一个是拷贝构造函数，当然还有一个有参构造函数，但是实际过程中我没有用到。无参构造函数用于上述类成员的初始化，拷贝构造函数用于复制一个相同的大数类进行运算。有参构造函数可以用于对类成员的复制。</p>
<h3 id=重载运算符>
重载运算符
<a class=heading-link href=#%e9%87%8d%e8%bd%bd%e8%bf%90%e7%ae%97%e7%ac%a6>
<i class="fa fa-link" aria-hidden=true></i>
</a>
</h3>
<h4 id=重载->
重载 &ldquo;+&rdquo;
<a class=heading-link href=#%e9%87%8d%e8%bd%bd->
<i class="fa fa-link" aria-hidden=true></i>
</a>
</h4>
<ul>
<li>首先在类中进行了声明, <code>BigNumber operator + (const BigNumber &b);</code> ，用当前类 *<strong>this</strong> 来和引入的类 <strong>b</strong> 进行加法运算，返回值为一个 <strong>BigNumber</strong> 类。</li>
<li>在类的外部进行重载的定义，先将用拷贝构造函数将当前的类 *<strong>this</strong> 拷贝为 <strong>a</strong> ，然后对 <strong>a</strong> 和 <strong>b</strong> 进行加法运算，模拟竖式，对应位相加，大于10则进位，最后去掉尾部的 0 即可。</li>
</ul>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp>BigNumber BigNumber::<span style=font-weight:700>operator</span> + (<span style=font-weight:700>const</span> BigNumber &amp;b) <span style=font-style:italic>//重载 &#34;+&#34; 定义 
</span><span style=font-style:italic></span>{
    
	BigNumber Result;
	BigNumber a(*<span style=font-weight:700>this</span>);
	Result.len = max(a.len,b.len)+1;
	<span>int</span> add=0;
	<span style=font-weight:700>for</span>(<span>int</span> i=0;i&lt;Result.len||add!=0;i++)
	{
		<span>int</span> p=add;
		<span style=font-weight:700>if</span>(i&lt;a.len) p+=a.v[i];
		<span style=font-weight:700>if</span>(i&lt;b.len) p+=b.v[i];
		add=p/10;
		Result.v.push_back(p%10);
	}
	<span style=font-weight:700>while</span>(Result.v[Result.v.size()-1]==0 &amp;&amp; Result.v.size() &gt; 1)
	{
		Result.v.pop_back();
	}
	Result.len=Result.v.size();
	<span style=font-weight:700>return</span> Result;
    
}
</code></pre></div><h4 id=重载--1>
重载 &ldquo;&lt;&rdquo;
<a class=heading-link href=#%e9%87%8d%e8%bd%bd--1>
<i class="fa fa-link" aria-hidden=true></i>
</a>
</h4>
<p>​    因为进行减法前需要比较两个大数类的大小，我就先重载了 <strong>&lt;</strong> 。思路就是先比较<strong>a、b</strong>两个大数的长度，长的那个肯定比较大，如果两个长度相等。从尾部开始依次向前比较，如果不相等的话，就看两个数的相对大小，大的那个肯定整体比较大。如果总是相等，到了最后，就返回相应的值表示他们相等。<strong>这里我的返回值为int类型，用的标记是：如果两个相等，返回-1，如果前者小于后者，返回1，如果前者大于后者，返回0.</strong></p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span>int</span>  BigNumber::<span style=font-weight:700>operator</span> &lt; (<span style=font-weight:700>const</span> BigNumber &amp;b) <span style=font-style:italic>// 重载 &#34;&lt;&#34; 定义 
</span><span style=font-style:italic></span>{
	BigNumber a(*<span style=font-weight:700>this</span>);
	
	<span style=font-weight:700>if</span>(a.len &lt; b.len) <span style=font-weight:700>return</span> 1;
	<span style=font-weight:700>if</span>(a.len &gt; b.len) <span style=font-weight:700>return</span> 0;
	
	<span style=font-weight:700>for</span>(<span>int</span> i=a.len-1;i&gt;=0;i--)
	{
		<span style=font-weight:700>if</span>(a.v[i]!=b.v[i])
		{
			<span style=font-weight:700>return</span> a.v[i] &lt; b.v[i];
		}
	}
	<span style=font-weight:700>return</span> -1;
}
</code></pre></div><h4 id=重载-->
重载 &ldquo;-&rdquo;
<a class=heading-link href=#%e9%87%8d%e8%bd%bd-->
<i class="fa fa-link" aria-hidden=true></i>
</a>
</h4>
<ul>
<li>首先在类中进行了声明, <code>BigNumber operator - (BigNumber &b);</code> ，用当前类 *<strong>this</strong> 来和引入的类 <strong>b</strong> 进行减法运算，返回值为一个 <strong>BigNumber</strong> 类。</li>
<li>在类的外部进行重载的定义，先将用拷贝构造函数将当前的类 *<strong>this</strong> 拷贝为 <strong>a</strong> ，然后对 <strong>a</strong> 和 <strong>b</strong> 进行减法运算。如果 <strong>a&lt;b</strong> ，那么我们就把 <strong>flag</strong> 设为 <strong>true</strong> ，标志得数为一个负数，然后用 <strong>swap</strong> 交换两个类，保证总是大数减小数。减法的话就是从前往后扫，对应位相减，如果不够减的就进行借位。如果借完位当前位置小于0了，那么就再向前借位。最后要去掉结尾多于的0.</li>
</ul>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp>BigNumber BigNumber::<span style=font-weight:700>operator</span> - (BigNumber &amp;b) <span style=font-style:italic>// 重载 &#34;-&#34; 定义 
</span><span style=font-style:italic></span>{
	BigNumber Result;
	BigNumber a(*<span style=font-weight:700>this</span>);
	<span style=font-weight:700>if</span>(a&lt;b==1)
	{
		swap(a,b);
		Result.flag=true;
	}
	Result.len=a.len;
	<span style=font-weight:700>for</span>(<span>int</span> i=0;i&lt;a.len;i++)
	{
		<span style=font-weight:700>if</span>(a.v[i]&lt;0)
		{
			a.v[i]+=10;
			a.v[i+1]--;
		} 
		<span style=font-weight:700>if</span>(a.v[i] &lt; b.v[i]&amp;&amp;i&lt;b.len)
		{
			a.v[i]+=10;
			a.v[i+1]--;
		}
		<span style=font-weight:700>if</span>(i&lt;b.len)
		Result.v.push_back(a.v[i]-b.v[i]);
		<span style=font-weight:700>else</span> Result.v.push_back(a.v[i]);
	}
	<span style=font-weight:700>while</span>(Result.v[Result.len-1]==0 &amp;&amp; Result.len &gt; 1)
	{
		Result.v.pop_back();
		Result.len--;
	}
	<span style=font-weight:700>return</span> Result;
}
</code></pre></div><h4 id=重载--2>
重载 &ldquo;*&rdquo;
<a class=heading-link href=#%e9%87%8d%e8%bd%bd--2>
<i class="fa fa-link" aria-hidden=true></i>
</a>
</h4>
<ul>
<li>首先在类中进行了声明, <code>BigNumber operator * (BigNumber &b);</code>，用当前类 *<strong>this</strong> 来和引入的类 <strong>b</strong> 进行乘法运算，返回值为一个 <strong>BigNumber</strong> 类。</li>
<li>在类的外部进行重载的定义，先将用拷贝构造函数将当前的类 *<strong>this</strong> 拷贝为 <strong>a</strong> ，然后对 <strong>a</strong> 和 <strong>b</strong> 进行乘法运算。乘法也是模拟竖式运算，两个位数相乘对应的得数中的哪一位不难发现，因此只需要边乘边进位即可，一开始想的是所有乘完之后再进位，后来想了想运算的次序不会影响除和模的运算，所以就可以边乘边取商和模，可以少掉两层循环。算是一个小小的优化。最后要去掉结尾多于的0.</li>
</ul>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp>BigNumber BigNumber::<span style=font-weight:700>operator</span> * (BigNumber &amp;b) <span style=font-style:italic>// 重载 &#34;*&#34;  定义 
</span><span style=font-style:italic></span>{
	BigNumber Result;
	BigNumber a(*<span style=font-weight:700>this</span>);
	Result.len=a.len+b.len;
	<span style=font-weight:700>for</span>(<span>int</span> i=0;i&lt;Result.len;i++) Result.v.push_back(0);
	<span style=font-weight:700>for</span>(<span>int</span> i=0;i&lt;a.len;i++)
	{
		<span style=font-weight:700>for</span>(<span>int</span> j=0;j&lt;b.len;j++)
		{
			Result.v[i+j]+=a.v[i]*b.v[j];
			Result.v[i+j+1]+=Result.v[i+j]/10;
			Result.v[i+j]%=10;
		}
	}
	<span style=font-weight:700>while</span>(Result.v[Result.v.size()-1]==0 &amp;&amp; Result.v.size() &gt; 1)
	{
		Result.v.pop_back();
	}
	Result.len=Result.v.size();
	<span style=font-weight:700>return</span> Result;
}
</code></pre></div><h4 id=重载---1>
重载 &ldquo;/&rdquo;
<a class=heading-link href=#%e9%87%8d%e8%bd%bd---1>
<i class="fa fa-link" aria-hidden=true></i>
</a>
</h4>
<ul>
<li>
<p>首先在类中进行了声明,<code>BigNumber operator / (BigNumber &b);</code>，用当前类 *<strong>this</strong> 来和引入的类 <strong>b</strong> 进行除法运算，返回值为一个 <strong>BigNumber</strong> 类。</p>
</li>
<li>
<p>在类的外部进行重载的定义，先将用拷贝构造函数将当前的类 *<strong>this</strong> 拷贝为 <strong>a</strong> ，然后对 <strong>a</strong> 和 <strong>b</strong> 进行除法法运算。我选择了做除法的时候大数类中同时存储商和余数，这样可以加快效率，因为我自己的想法是把除法和取模一起处理，求得商的同时，模也能求出来。因此他们的框架肯定是相差无几的，所以我选择了一次性算出来两个，在大数类中用两个vector数组分别存商和余数，求商和余数我用的是减法的策略，分下面三种情况来讨论</p>
<ul>
<li><strong>a&lt;b</strong> ：很显然商为0，余数为a。</li>
<li><strong>a==b</strong> ：很显然商为1，余数为0。</li>
<li><strong>a>b</strong> ：这个是最难处理的，我们想想一下模拟除法的竖式运算，先在b的后面填0，让a和b的位数相同，然后再一直对a进行减法运算，将得到的数排列起来即可。里面细节还是挺多的，具体的看代码。最后要去掉结尾多于的0.</li>
</ul>
</li>
</ul>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp>BigNumber BigNumber::<span style=font-weight:700>operator</span> / (BigNumber &amp;b) <span style=font-style:italic>// 重载 &#34;/&#34; 定义 
</span><span style=font-style:italic></span>{
	BigNumber Result;
	BigNumber a(*<span style=font-weight:700>this</span>);
	<span style=font-weight:700>if</span>(a&lt;b==1)
	{
		Result.v.push_back(0);
		<span style=font-weight:700>for</span>(<span>int</span> i=0;i&lt;a.v.size();i++)
		{
			Result.m.push_back(a.v[i]);
		}
		<span style=font-weight:700>return</span> Result;
	}
	<span style=font-weight:700>if</span>(a&lt;b==-1)
	{
		Result.v.push_back(1);
		Result.m.push_back(0);
		Result.len=1;
	}
	<span style=font-weight:700>if</span>(a&lt;b==0)
	{
		<span>int</span> size = a.len-b.len;
		<span style=font-weight:700>for</span>(<span>int</span> i=size;i&gt;=0;i--)
		{
			BigNumber p(b);
			<span>int</span> cnt=0;
			<span style=font-weight:700>for</span>(<span>int</span> j=1;j&lt;=i;j++)
			{
				p.v.insert(p.v.begin(),0);
			}
			p.len = p.v.size();
			<span style=font-weight:700>while</span>((a-p).flag==false)
			{
				a=a-p;
				cnt++;
			}
			<span style=font-weight:700>if</span>(i==size)
			{
				<span style=font-weight:700>for</span>(<span>int</span> j=1;j&lt;=size;j++)
				{
					Result.v.push_back(0);
				}
				Result.v.push_back(cnt);
			}
			<span style=font-weight:700>else</span>
			{
				Result.v[i] = cnt;
			}
		}
		<span style=font-weight:700>while</span>(Result.v[Result.v.size()-1]==0 &amp;&amp; Result.v.size() &gt; 1)
		{
			Result.v.pop_back();
		}
		Result.len=Result.v.size();
		<span style=font-weight:700>for</span>(<span>int</span> i=0;i&lt;a.v.size();i++)
		{
			Result.m.push_back(a.v[i]);
		}
	}
	<span style=font-weight:700>return</span> Result;
}
</code></pre></div><h4 id=重载--3>
重载 &ldquo;%&rdquo;
<a class=heading-link href=#%e9%87%8d%e8%bd%bd--3>
<i class="fa fa-link" aria-hidden=true></i>
</a>
</h4>
<p>​ 这个和除法的类似，我们除法的其实已经求出来模了，这个只是象征性的搞一搞。QAQ。</p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp>BigNumber BigNumber::<span style=font-weight:700>operator</span> % (BigNumber &amp;b) <span style=font-style:italic>//重载 &#34;%&#34; 定义 
</span><span style=font-style:italic></span>{
	BigNumber Result;
	BigNumber a(*<span style=font-weight:700>this</span>);
	<span style=font-weight:700>if</span>(a&lt;b)
	{
		Result.v.push_back(0);
		<span style=font-weight:700>return</span> Result;
	}
	<span style=font-weight:700>else</span>
	{
		<span>int</span> size = a.len-b.len;
		<span style=font-weight:700>for</span>(<span>int</span> i=size;i&gt;=0;i--)
		{
			BigNumber p(b);
			<span style=font-weight:700>for</span>(<span>int</span> j=1;j&lt;=i;j++)
			{
				p.v.insert(p.v.begin(),0);
			}
			p.len = p.v.size();
			<span style=font-weight:700>while</span>((a-p).flag==false)
			{
				a=a-p;
			}
		}
		<span style=font-weight:700>for</span>(<span>int</span> i=0;i&lt;a.v.size();i++)
		{
			Result.v.push_back(a.v[i]);
		}
	}
	<span style=font-weight:700>return</span> Result;
} 
</code></pre></div><h3 id=其中遇到的问题>
其中遇到的问题
<a class=heading-link href=#%e5%85%b6%e4%b8%ad%e9%81%87%e5%88%b0%e7%9a%84%e9%97%ae%e9%a2%98>
<i class="fa fa-link" aria-hidden=true></i>
</a>
</h3>
<ul>
<li>在做减法的时候，会出现莫名奇怪的数据，后来发现是由于访问b数组的时候越界，而且vector数组的clear只是将数组的size置为了0，而不是将所有数据都莫抹除，而且vector通过下标访问越界还不会报错，我整个人都傻了，调了巨长时间。</li>
<li>在做除法的时候，一度自闭。本来是只是一直减，这样效率真的巨tm慢。后来想到了用这个办法好像可以优化到 log 级别的，但是好难调试啊。。从昨天下午一直搞到现在。</li>
<li>因为swap这个东西，好像会影响到类的源数据，所以我就多定义了几个数，分别对他们进行操作，这样就不会相互影响，虽然看起来挺丑的。</li>
</ul>
<h3 id=整体的代码实现>
整体的代码实现
<a class=heading-link href=#%e6%95%b4%e4%bd%93%e7%9a%84%e4%bb%a3%e7%a0%81%e5%ae%9e%e7%8e%b0>
<i class="fa fa-link" aria-hidden=true></i>
</a>
</h3>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=font-style:italic>/*
</span><span style=font-style:italic>	Name: BigNumber Class
</span><span style=font-style:italic>	Copyright: Zs
</span><span style=font-style:italic>	Author: Zs
</span><span style=font-style:italic>	Date: 04/04/20 09:08
</span><span style=font-style:italic>	Description: A BigNumber Class
</span><span style=font-style:italic>*/</span>

<span>#include</span><span>&lt;cstdio&gt;</span><span>
</span><span>#include</span><span>&lt;cstring&gt;</span><span>
</span><span>#include</span><span>&lt;algorithm&gt;</span><span>
</span><span>#include</span><span>&lt;cmath&gt;</span><span>
</span><span>#include</span><span>&lt;iostream&gt;</span><span>
</span><span>#include</span><span>&lt;vector&gt;</span><span>
</span><span></span>
<span style=font-weight:700>using</span> <span style=font-weight:700>namespace</span> std;

<span style=font-weight:700>class</span> <span style=font-weight:700>BigNumber</span>
{
	<span style=font-weight:700>private</span>:
		vector&lt;<span>int</span>&gt; v; <span style=font-style:italic>// 和，差，积，商 
</span><span style=font-style:italic></span>		vector&lt;<span>int</span>&gt; m; <span style=font-style:italic>// 余数，当无余数的时候 size 为0 
</span><span style=font-style:italic></span>		<span>int</span> len;  <span style=font-style:italic>// 数字的长度 = v.size() 
</span><span style=font-style:italic></span>		<span>bool</span> flag; <span style=font-style:italic>//是否为负数的标志 
</span><span style=font-style:italic></span>	<span style=font-weight:700>public</span>:
		BigNumber();<span style=font-style:italic>//无参构造函数 
</span><span style=font-style:italic></span>		BigNumber(string s)  <span style=font-style:italic>//带参数的构造函数 
</span><span style=font-style:italic></span>		{
			*<span style=font-weight:700>this</span>=s;
		}
		BigNumber(<span style=font-weight:700>const</span> BigNumber &amp;); <span style=font-style:italic>// 拷贝构造函数 
</span><span style=font-style:italic></span>		BigNumber <span style=font-weight:700>operator</span> = (<span style=font-weight:700>const</span> string s);  <span style=font-style:italic>// 重载 &#34;=&#34; 声明 
</span><span style=font-style:italic></span>		BigNumber <span style=font-weight:700>operator</span> = (<span>int</span> k);  <span style=font-style:italic>// 重载输入的数为整型的时候的 &#34;=&#34; 声明
</span><span style=font-style:italic></span>		
		<span>int</span> <span style=font-weight:700>operator</span> &lt; (<span style=font-weight:700>const</span> BigNumber &amp;b);  <span style=font-style:italic>// 重载 &#34;&lt;&#34; 声明 
</span><span style=font-style:italic></span>		BigNumber <span style=font-weight:700>operator</span> + (<span style=font-weight:700>const</span> BigNumber &amp;b); <span style=font-style:italic>// 重载 &#34;+&#34; 声明 
</span><span style=font-style:italic></span>		BigNumber <span style=font-weight:700>operator</span> - (BigNumber &amp;b); <span style=font-style:italic>// 重载 &#34;-&#34; 声明 
</span><span style=font-style:italic></span>		BigNumber <span style=font-weight:700>operator</span> * (BigNumber &amp;b);  <span style=font-style:italic>// 重载 &#34;*&#34; 声明 
</span><span style=font-style:italic></span>		BigNumber <span style=font-weight:700>operator</span> / (BigNumber &amp;b); <span style=font-style:italic>//重载 &#34;/&#34; 声明 
</span><span style=font-style:italic></span>		BigNumber <span style=font-weight:700>operator</span> % (BigNumber &amp;b); <span style=font-style:italic>//重载 &#34;%&#34; 声明 
</span><span style=font-style:italic></span>		
		<span>void</span> print() <span style=font-style:italic>//输出函数 
</span><span style=font-style:italic></span>		{
			<span style=font-weight:700>if</span>(flag)
			{
				printf(<span style=font-style:italic>&#34;-&#34;</span>);
				flag=false;
			}
			<span style=font-weight:700>for</span>(<span>int</span> i=v.size()-1;i&gt;=0;i--) printf(<span style=font-style:italic>&#34;%d&#34;</span>,v[i]);
			printf(<span style=font-style:italic>&#34;</span><span style=font-weight:700;font-style:italic>\n</span><span style=font-style:italic>&#34;</span>);
			<span style=font-weight:700>for</span>(<span>int</span> i=m.size()-1;i&gt;=0;i--) printf(<span style=font-style:italic>&#34;%d&#34;</span>,m[i]);
		}
		
};

BigNumber::BigNumber() <span style=font-style:italic>//无参构造函数 
</span><span style=font-style:italic></span>{
	v.clear();
	m.clear();
	len = 0;
	flag=false;
}
BigNumber::BigNumber(<span style=font-weight:700>const</span> BigNumber &amp;T) <span style=font-style:italic>// 拷贝构造函数 
</span><span style=font-style:italic></span>{
	v.assign(T.v.begin(),T.v.end());
	len = T.len;
	flag = T.flag;
}

BigNumber BigNumber::<span style=font-weight:700>operator</span> = (<span style=font-weight:700>const</span> string s) <span style=font-style:italic>// 重载 &#34;=&#34; 定义 
</span><span style=font-style:italic></span>{
	len = s.length();
	<span style=font-weight:700>for</span>(<span>int</span> i=0;i&lt;len;i++)
	{
		v.push_back(s[len-1-i]-<span style=font-style:italic>&#39;0&#39;</span>);
	}
	<span style=font-weight:700>return</span> *<span style=font-weight:700>this</span>;
}
BigNumber BigNumber::<span style=font-weight:700>operator</span> = (<span>int</span> k) <span style=font-style:italic>// 重载输入的数为整型的时候的 &#34;=&#34; 定义 
</span><span style=font-style:italic></span>{
	<span style=font-weight:700>while</span>(k)
	{
		v.push_back(k%10);
		k/=10;
		len++; 
	}
	len--;
	<span style=font-weight:700>return</span> *<span style=font-weight:700>this</span>;
}

<span>int</span>  BigNumber::<span style=font-weight:700>operator</span> &lt; (<span style=font-weight:700>const</span> BigNumber &amp;b) <span style=font-style:italic>// 重载 &#34;&lt;&#34; 定义 
</span><span style=font-style:italic></span>{
	BigNumber a(*<span style=font-weight:700>this</span>);
	
	<span style=font-weight:700>if</span>(a.len &lt; b.len) <span style=font-weight:700>return</span> 1;
	<span style=font-weight:700>if</span>(a.len &gt; b.len) <span style=font-weight:700>return</span> 0;
	
	<span style=font-weight:700>for</span>(<span>int</span> i=a.len-1;i&gt;=0;i--)
	{
		<span style=font-weight:700>if</span>(a.v[i]!=b.v[i])
		{
			<span style=font-weight:700>return</span> a.v[i] &lt; b.v[i];
		}
	}
	<span style=font-weight:700>return</span> -1;
}
BigNumber BigNumber::<span style=font-weight:700>operator</span> + (<span style=font-weight:700>const</span> BigNumber &amp;b) <span style=font-style:italic>//重载 &#34;+&#34; 定义 
</span><span style=font-style:italic></span>{
	
	BigNumber Result;
	BigNumber a(*<span style=font-weight:700>this</span>);
	Result.len = max(a.len,b.len)+1;
	<span>int</span> add=0;
	<span style=font-weight:700>for</span>(<span>int</span> i=0;i&lt;Result.len||add!=0;i++)
	{
		<span>int</span> p=add;
		<span style=font-weight:700>if</span>(i&lt;a.len) p+=a.v[i];
		<span style=font-weight:700>if</span>(i&lt;b.len) p+=b.v[i];
		add=p/10;
		Result.v.push_back(p%10);
	}
	<span style=font-weight:700>while</span>(Result.v[Result.v.size()-1]==0 &amp;&amp; Result.v.size() &gt; 1)
	{
		Result.v.pop_back();
	}
	Result.len=Result.v.size();
	<span style=font-weight:700>return</span> Result;
	
}
BigNumber BigNumber::<span style=font-weight:700>operator</span> - (BigNumber &amp;b) <span style=font-style:italic>// 重载 &#34;-&#34; 定义 
</span><span style=font-style:italic></span>{
	BigNumber Result;
	BigNumber a(*<span style=font-weight:700>this</span>);
	<span style=font-weight:700>if</span>(a&lt;b==1)
	{
		swap(a,b);
		Result.flag=true;
	}
	Result.len=a.len;
	<span style=font-weight:700>for</span>(<span>int</span> i=0;i&lt;a.len;i++)
	{
		<span style=font-weight:700>if</span>(a.v[i]&lt;0)
		{
			a.v[i]+=10;
			a.v[i+1]--;
		} 
		<span style=font-weight:700>if</span>(a.v[i] &lt; b.v[i]&amp;&amp;i&lt;b.len)
		{
			a.v[i]+=10;
			a.v[i+1]--;
		}
		<span style=font-weight:700>if</span>(i&lt;b.len)
		Result.v.push_back(a.v[i]-b.v[i]);
		<span style=font-weight:700>else</span> Result.v.push_back(a.v[i]);
	}
	<span style=font-weight:700>while</span>(Result.v[Result.len-1]==0 &amp;&amp; Result.len &gt; 1)
	{
		Result.v.pop_back();
		Result.len--;
	}
	<span style=font-weight:700>return</span> Result;
}

BigNumber BigNumber::<span style=font-weight:700>operator</span> * (BigNumber &amp;b) <span style=font-style:italic>// 重载 &#34;*&#34;  定义 
</span><span style=font-style:italic></span>{
	BigNumber Result;
	BigNumber a(*<span style=font-weight:700>this</span>);
	Result.len=a.len+b.len;
	<span style=font-weight:700>for</span>(<span>int</span> i=0;i&lt;Result.len;i++) Result.v.push_back(0);
	<span style=font-weight:700>for</span>(<span>int</span> i=0;i&lt;a.len;i++)
	{
		<span style=font-weight:700>for</span>(<span>int</span> j=0;j&lt;b.len;j++)
		{
			Result.v[i+j]+=a.v[i]*b.v[j];
			Result.v[i+j+1]+=Result.v[i+j]/10;
			Result.v[i+j]%=10;
		}
	}
	<span style=font-weight:700>while</span>(Result.v[Result.v.size()-1]==0 &amp;&amp; Result.v.size() &gt; 1)
	{
		Result.v.pop_back();
	}
	Result.len=Result.v.size();
	<span style=font-weight:700>return</span> Result;
}

BigNumber BigNumber::<span style=font-weight:700>operator</span> / (BigNumber &amp;b) <span style=font-style:italic>// 重载 &#34;/&#34; 定义 
</span><span style=font-style:italic></span>{
	BigNumber Result;
	BigNumber a(*<span style=font-weight:700>this</span>);
	<span style=font-weight:700>if</span>(a&lt;b==1)
	{
		Result.v.push_back(0);
		<span style=font-weight:700>for</span>(<span>int</span> i=0;i&lt;a.v.size();i++)
		{
			Result.m.push_back(a.v[i]);
		}
		<span style=font-weight:700>return</span> Result;
	}
	<span style=font-weight:700>if</span>(a&lt;b==-1)
	{
		Result.v.push_back(1);
		Result.m.push_back(0);
		Result.len=1;
	}
	<span style=font-weight:700>if</span>(a&lt;b==0)
	{
		<span>int</span> size = a.len-b.len;
		<span style=font-weight:700>for</span>(<span>int</span> i=size;i&gt;=0;i--)
		{
			BigNumber p(b);
			<span>int</span> cnt=0;
			<span style=font-weight:700>for</span>(<span>int</span> j=1;j&lt;=i;j++)
			{
				p.v.insert(p.v.begin(),0);
			}
			p.len = p.v.size();
			<span style=font-weight:700>while</span>((a-p).flag==false)
			{
				a=a-p;
				cnt++;
			}
			<span style=font-weight:700>if</span>(i==size)
			{
				<span style=font-weight:700>for</span>(<span>int</span> j=1;j&lt;=size;j++)
				{
					Result.v.push_back(0);
				}
				Result.v.push_back(cnt);
			}
			<span style=font-weight:700>else</span>
			{
				Result.v[i] = cnt;
			}
		}
		<span style=font-weight:700>while</span>(Result.v[Result.v.size()-1]==0 &amp;&amp; Result.v.size() &gt; 1)
		{
			Result.v.pop_back();
		}
		Result.len=Result.v.size();
		<span style=font-weight:700>for</span>(<span>int</span> i=0;i&lt;a.v.size();i++)
		{
			Result.m.push_back(a.v[i]);
		}
	}
	<span style=font-weight:700>return</span> Result;
}
BigNumber BigNumber::<span style=font-weight:700>operator</span> % (BigNumber &amp;b) <span style=font-style:italic>//重载 &#34;%&#34; 定义 
</span><span style=font-style:italic></span>{
	BigNumber Result;
	BigNumber a(*<span style=font-weight:700>this</span>);
	<span style=font-weight:700>if</span>(a&lt;b)
	{
		Result.v.push_back(0);
		<span style=font-weight:700>return</span> Result;
	}
	<span style=font-weight:700>else</span>
	{
		<span>int</span> size = a.len-b.len;
		<span style=font-weight:700>for</span>(<span>int</span> i=size;i&gt;=0;i--)
		{
			BigNumber p(b);
			<span style=font-weight:700>for</span>(<span>int</span> j=1;j&lt;=i;j++)
			{
				p.v.insert(p.v.begin(),0);
			}
			p.len = p.v.size();
			<span style=font-weight:700>while</span>((a-p).flag==false)
			{
				a=a-p;
			}
		}
		<span style=font-weight:700>for</span>(<span>int</span> i=0;i&lt;a.v.size();i++)
		{
			Result.v.push_back(a.v[i]);
		}
	}
	<span style=font-weight:700>return</span> Result;
} 
<span>int</span> main()
{
<span style=font-style:italic>//	freopen(&#34;test.in&#34;,&#34;r&#34;,stdin);
</span><span style=font-style:italic>//	freopen(&#34;test.out&#34;,&#34;w&#34;,stdout);
</span><span style=font-style:italic></span>	string s1,s2;
	cin&gt;&gt;s1&gt;&gt;s2;
	BigNumber a,b,c,e,f,k,j;
	a=s1,b=s2;
	e=s1,f=s2;
	k=s1,j=s2;
	c=a+b;
	c.print();
	c=a-b;
	c.print();
	c=k*j;
	c.print();
	c=e%f;
	c.print();
	<span style=font-weight:700>return</span> 0;
}
</code></pre></div>
</div>
<footer>
</footer>
</article>
</section>
</div>
<footer class=footer>
<section class=container>
©
2019 -
2021
zzsqwq
·
<a href=https://gohugo.io/>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/>Coder</a>.
</section>
</footer>
</main>
<script src=/Zs-Hugo-Blog/js/coder.min.03b17769f4f91ae35667e1f2a1ca8c16f50562576cf90ff32b3179926914daa5.js integrity="sha256-A7F3afT5GuNWZ+HyocqMFvUFYlds+Q/zKzF5kmkU2qU="></script>
</body>
</html>