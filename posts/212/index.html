<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>纯终端环境代理配置教程 | Zs's Blog</title><meta name=keywords content="Linux,v2ray,代理"><meta name=description content="纯终端环境代理配置教程 前言 我们在很多情况下，可能会在云服务器或是其他纯终端环境（例如树莓派服务器等），或者一些没有屏幕的情况下，只能 ssh 链接到服务器上进行一些操作。
这些时候，如果我们想要克隆一个 Github 的仓库，或者下载一些镜像源中没有的文件，简直是难如登天，100kb/s 的速度都很罕见，因此在这种环境下配一个代理还是十分必要的！
我们常在 Linux 上使用的 GUI 代理软件如 Qv2ray、Clash 这些就没法用了。因此需要考虑如何在纯终端环境中配置代理的问题，这篇教程就是为解决此问题而写的。
教程 此教程搭配的是常用的 v2ray-core + v2rayA ，这里的 v2rayA 是一个网页端的代理管理工具，其中支持 v2ray、Xray、SS、SSR、Trojan 等多种协议。
一、安装 v2ray-core 首先是需要安装 v2ray-core ，这里我们使用开源的项目 v2fly/fhs-install-v2ray 进行安装，它是一个脚本，可以直接运行完成 v2ray 的安装，安装的文件组织结构符合 Filesystem Hierarchy Standard ，十分方便简洁，很赞！
具体步骤如下：
下载 fhs-install-v2ray 源码 首先我们因为 Github 克隆很慢，可以先在自己的主机上克隆或者以 zip 包形式下载源码
将源码上传到远端 键入下列代码，通过 scp 将解压后的代码文件夹目录上传到远端服务器的根目录（如果是树莓派的话可以连接同一局域网进行），注意这里的 path/to/fhs-install-v2ray 指的是本地文件夹的路径
scp -r path/to/fhs-install-v2ray username@hostname:~
下载 v2ray-core 源码 此脚本可以全自动安装，即自动检测本机类型是 Ubuntu 还是其他的版本，然后从远端仓库下载最新的 v2ray 进行安装，不过因为没有代理，这一步还是十分缓慢，因此我们可以进行本地安装。
首先，我们去到 v2ray-core 的官方仓库的发布站 -> Releases · v2fly/v2ray-core ，在这里可以下载最新版本的的 v2ray-core，不过需要注意的是，需要自己辨别版本，如使用的是 arm 还是 x64_86 等，下载后是一个 zip 压缩包，我们直接通过 scp 上传到远端服务器根目录"><meta name=author content="zzsqwq"><link rel=canonical href=https://blog.zzsqwq.cn/posts/212/><meta name=google-site-verification content="G-WF7TH97J9X"><link crossorigin=anonymous href=/assets/css/stylesheet.0c4fd3725171366f335155acde6fb3c7b7042cd2fd075bebf5023d9b28a701b2.css integrity="sha256-DE/TclFxNm8zUVWs3m+zx7cELNL9B1vr9QI9myinAbI=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.zzsqwq.cn/images/avatar.png><link rel=icon type=image/png sizes=16x16 href=https://blog.zzsqwq.cn/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.zzsqwq.cn/images/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.zzsqwq.cn/apple-touch-icon.png><link rel=mask-icon href=https://blog.zzsqwq.cn/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-WF7TH97J9X"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-WF7TH97J9X",{anonymize_ip:!1})}</script><meta property="og:title" content="纯终端环境代理配置教程"><meta property="og:description" content="纯终端环境代理配置教程 前言 我们在很多情况下，可能会在云服务器或是其他纯终端环境（例如树莓派服务器等），或者一些没有屏幕的情况下，只能 ssh 链接到服务器上进行一些操作。
这些时候，如果我们想要克隆一个 Github 的仓库，或者下载一些镜像源中没有的文件，简直是难如登天，100kb/s 的速度都很罕见，因此在这种环境下配一个代理还是十分必要的！
我们常在 Linux 上使用的 GUI 代理软件如 Qv2ray、Clash 这些就没法用了。因此需要考虑如何在纯终端环境中配置代理的问题，这篇教程就是为解决此问题而写的。
教程 此教程搭配的是常用的 v2ray-core + v2rayA ，这里的 v2rayA 是一个网页端的代理管理工具，其中支持 v2ray、Xray、SS、SSR、Trojan 等多种协议。
一、安装 v2ray-core 首先是需要安装 v2ray-core ，这里我们使用开源的项目 v2fly/fhs-install-v2ray 进行安装，它是一个脚本，可以直接运行完成 v2ray 的安装，安装的文件组织结构符合 Filesystem Hierarchy Standard ，十分方便简洁，很赞！
具体步骤如下：
下载 fhs-install-v2ray 源码 首先我们因为 Github 克隆很慢，可以先在自己的主机上克隆或者以 zip 包形式下载源码
将源码上传到远端 键入下列代码，通过 scp 将解压后的代码文件夹目录上传到远端服务器的根目录（如果是树莓派的话可以连接同一局域网进行），注意这里的 path/to/fhs-install-v2ray 指的是本地文件夹的路径
scp -r path/to/fhs-install-v2ray username@hostname:~
下载 v2ray-core 源码 此脚本可以全自动安装，即自动检测本机类型是 Ubuntu 还是其他的版本，然后从远端仓库下载最新的 v2ray 进行安装，不过因为没有代理，这一步还是十分缓慢，因此我们可以进行本地安装。
首先，我们去到 v2ray-core 的官方仓库的发布站 -> Releases · v2fly/v2ray-core ，在这里可以下载最新版本的的 v2ray-core，不过需要注意的是，需要自己辨别版本，如使用的是 arm 还是 x64_86 等，下载后是一个 zip 压缩包，我们直接通过 scp 上传到远端服务器根目录"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.zzsqwq.cn/posts/212/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-09-13T18:15:00+00:00"><meta property="article:modified_time" content="2021-09-13T18:15:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="纯终端环境代理配置教程"><meta name=twitter:description content="纯终端环境代理配置教程 前言 我们在很多情况下，可能会在云服务器或是其他纯终端环境（例如树莓派服务器等），或者一些没有屏幕的情况下，只能 ssh 链接到服务器上进行一些操作。
这些时候，如果我们想要克隆一个 Github 的仓库，或者下载一些镜像源中没有的文件，简直是难如登天，100kb/s 的速度都很罕见，因此在这种环境下配一个代理还是十分必要的！
我们常在 Linux 上使用的 GUI 代理软件如 Qv2ray、Clash 这些就没法用了。因此需要考虑如何在纯终端环境中配置代理的问题，这篇教程就是为解决此问题而写的。
教程 此教程搭配的是常用的 v2ray-core + v2rayA ，这里的 v2rayA 是一个网页端的代理管理工具，其中支持 v2ray、Xray、SS、SSR、Trojan 等多种协议。
一、安装 v2ray-core 首先是需要安装 v2ray-core ，这里我们使用开源的项目 v2fly/fhs-install-v2ray 进行安装，它是一个脚本，可以直接运行完成 v2ray 的安装，安装的文件组织结构符合 Filesystem Hierarchy Standard ，十分方便简洁，很赞！
具体步骤如下：
下载 fhs-install-v2ray 源码 首先我们因为 Github 克隆很慢，可以先在自己的主机上克隆或者以 zip 包形式下载源码
将源码上传到远端 键入下列代码，通过 scp 将解压后的代码文件夹目录上传到远端服务器的根目录（如果是树莓派的话可以连接同一局域网进行），注意这里的 path/to/fhs-install-v2ray 指的是本地文件夹的路径
scp -r path/to/fhs-install-v2ray username@hostname:~
下载 v2ray-core 源码 此脚本可以全自动安装，即自动检测本机类型是 Ubuntu 还是其他的版本，然后从远端仓库下载最新的 v2ray 进行安装，不过因为没有代理，这一步还是十分缓慢，因此我们可以进行本地安装。
首先，我们去到 v2ray-core 的官方仓库的发布站 -> Releases · v2fly/v2ray-core ，在这里可以下载最新版本的的 v2ray-core，不过需要注意的是，需要自己辨别版本，如使用的是 arm 还是 x64_86 等，下载后是一个 zip 压缩包，我们直接通过 scp 上传到远端服务器根目录"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://blog.zzsqwq.cn/posts/"},{"@type":"ListItem","position":3,"name":"纯终端环境代理配置教程","item":"https://blog.zzsqwq.cn/posts/212/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"纯终端环境代理配置教程","name":"纯终端环境代理配置教程","description":"纯终端环境代理配置教程 前言 我们在很多情况下，可能会在云服务器或是其他纯终端环境（例如树莓派服务器等），或者一些没有屏幕的情况下，只能 ssh 链接到服务器上进行一些操作。\n这些时候，如果我们想要克隆一个 Github 的仓库，或者下载一些镜像源中没有的文件，简直是难如登天，100kb/s 的速度都很罕见，因此在这种环境下配一个代理还是十分必要的！\n我们常在 Linux 上使用的 GUI 代理软件如 Qv2ray、Clash 这些就没法用了。因此需要考虑如何在纯终端环境中配置代理的问题，这篇教程就是为解决此问题而写的。\n教程 此教程搭配的是常用的 v2ray-core + v2rayA ，这里的 v2rayA 是一个网页端的代理管理工具，其中支持 v2ray、Xray、SS、SSR、Trojan 等多种协议。\n一、安装 v2ray-core 首先是需要安装 v2ray-core ，这里我们使用开源的项目 v2fly/fhs-install-v2ray 进行安装，它是一个脚本，可以直接运行完成 v2ray 的安装，安装的文件组织结构符合 Filesystem Hierarchy Standard ，十分方便简洁，很赞！\n具体步骤如下：\n下载 fhs-install-v2ray 源码 首先我们因为 Github 克隆很慢，可以先在自己的主机上克隆或者以 zip 包形式下载源码\n将源码上传到远端 键入下列代码，通过 scp 将解压后的代码文件夹目录上传到远端服务器的根目录（如果是树莓派的话可以连接同一局域网进行），注意这里的 path/to/fhs-install-v2ray 指的是本地文件夹的路径\nscp -r path/to/fhs-install-v2ray username@hostname:~\n下载 v2ray-core 源码 此脚本可以全自动安装，即自动检测本机类型是 Ubuntu 还是其他的版本，然后从远端仓库下载最新的 v2ray 进行安装，不过因为没有代理，这一步还是十分缓慢，因此我们可以进行本地安装。\n首先，我们去到 v2ray-core 的官方仓库的发布站 -\u0026gt; Releases · v2fly/v2ray-core ，在这里可以下载最新版本的的 v2ray-core，不过需要注意的是，需要自己辨别版本，如使用的是 arm 还是 x64_86 等，下载后是一个 zip 压缩包，我们直接通过 scp 上传到远端服务器根目录","keywords":["Linux","v2ray","代理"],"articleBody":"纯终端环境代理配置教程 前言 我们在很多情况下，可能会在云服务器或是其他纯终端环境（例如树莓派服务器等），或者一些没有屏幕的情况下，只能 ssh 链接到服务器上进行一些操作。\n这些时候，如果我们想要克隆一个 Github 的仓库，或者下载一些镜像源中没有的文件，简直是难如登天，100kb/s 的速度都很罕见，因此在这种环境下配一个代理还是十分必要的！\n我们常在 Linux 上使用的 GUI 代理软件如 Qv2ray、Clash 这些就没法用了。因此需要考虑如何在纯终端环境中配置代理的问题，这篇教程就是为解决此问题而写的。\n教程 此教程搭配的是常用的 v2ray-core + v2rayA ，这里的 v2rayA 是一个网页端的代理管理工具，其中支持 v2ray、Xray、SS、SSR、Trojan 等多种协议。\n一、安装 v2ray-core 首先是需要安装 v2ray-core ，这里我们使用开源的项目 v2fly/fhs-install-v2ray 进行安装，它是一个脚本，可以直接运行完成 v2ray 的安装，安装的文件组织结构符合 Filesystem Hierarchy Standard ，十分方便简洁，很赞！\n具体步骤如下：\n下载 fhs-install-v2ray 源码 首先我们因为 Github 克隆很慢，可以先在自己的主机上克隆或者以 zip 包形式下载源码\n将源码上传到远端 键入下列代码，通过 scp 将解压后的代码文件夹目录上传到远端服务器的根目录（如果是树莓派的话可以连接同一局域网进行），注意这里的 path/to/fhs-install-v2ray 指的是本地文件夹的路径\nscp -r path/to/fhs-install-v2ray username@hostname:~\n下载 v2ray-core 源码 此脚本可以全自动安装，即自动检测本机类型是 Ubuntu 还是其他的版本，然后从远端仓库下载最新的 v2ray 进行安装，不过因为没有代理，这一步还是十分缓慢，因此我们可以进行本地安装。\n首先，我们去到 v2ray-core 的官方仓库的发布站 -\u003e Releases · v2fly/v2ray-core ，在这里可以下载最新版本的的 v2ray-core，不过需要注意的是，需要自己辨别版本，如使用的是 arm 还是 x64_86 等，下载后是一个 zip 压缩包，我们直接通过 scp 上传到远端服务器根目录\nscp path/to/v2ray-linux-64.zip username@hostname:~\n连接远程服务器 接下来我们通过 ssh 连接到远程服务器\nssh username@hostname\n完成安装 然后进入根目录后，进入 fhs-install-v2ray 文件夹，会发现里面有两个脚本，一个是 install-dat-release.sh 另一个是 install-release.sh ，前者是带有路由规则的，后者是不带有路由规则的。我试用后发现 install-dat-release.sh 没有办法本地安装，而后者可以，同时因为 v2rayA 中会自带路由规则，因此完全没有必要用前者，我们可以直接使用 install-release.sh 进行安装。\n执行 sudo chmod +x install-release.sh ，添加执行权限\n执行 sudo ./install-release.sh --local ../v2ray-linux-64.zip\n这里的 local 参数代表是本地安装，解析后面的文件，注意这里是直接 zip 包，不需要解压。同时，这里的路径也是需要和你的下载的文件地址对应。\n不出意外的话，瞬间就可以安装完成。截止到这里，v2ray-core 已经安装成功。需要注意的是，这里不需要执行 sudo systemctl enable v2ray ，因为后续的 v2rayA 不依赖此服务。\n安装的文件路径如下：\ninstalled: /usr/local/bin/v2ray #v2ray 主程序地址 installed: /usr/local/bin/v2ctl\t#v2ray 控制程序 installed: /usr/local/share/v2ray/geoip.dat # 可选，路由信息 installed: /usr/local/share/v2ray/geosite.dat #可选，路由信息 installed: /usr/local/etc/v2ray/config.json #代理配置文件 installed: /var/log/v2ray/\t#下面三个都是log文件 installed: /var/log/v2ray/access.log installed: /var/log/v2ray/error.log installed: /etc/systemd/system/v2ray.service #v2ray 服务配置信息 installed: /etc/systemd/system/v2ray@.service 如果有报错的话，可以看对应的 error 报错去 v2fly/fhs-install-v2ray 官方仓库 Issue 处查看。\n二、安装 v2rayA 首先，同样的是，为了防止 Github 下载太慢，我们也可以去到官方仓库的发布站 -\u003e Releases · v2rayA/v2rayA ，下载对应系统版本的安装包，然后通过 scp 上传到远端。\n这里以 x64_86 版本的 Ubuntu 18.04.5 LTS 举例，我们直接下载 installer_debian_x64_v1.5.2.deb 到本地，然后执行\nscp path/to/installer_debian_x64_v1.5.2.deb username@hostname:~ 将文件上传到远端。\n然后 ssh 到服务器执行：\nsudo dpkg -i installer_debian_x64_v1.5.2.deb 安装成功后依次执行：\n# 启动 v2raya sudo systemctl start v2raya # 开机自启 v2raya sudo systemctl enable v2raya 这样就成功开启了 v2rayA，我们访问 ip:2017 ，前面是你云服务器的公网 ip 或者是自建服务器的局域网 ip ，我们就可以访问到对应的服务，界面大致如下：\n首次进入时会让你设置账号和密码，用于后续的管理。还会引导你导入链接，在导入链接后，就可以点击上方的第三栏，进行连接、查看或分享对应的代理了！\n说一下我现在用的设置，点击右上角设置，透明代理和规则端口的分流模式设置为大陆白名单，然后实现方式我用的是 redirect，每隔 24h 更新依次代理，左下角设置的地址与端口我用的是默认的，如下：\n这样我们就可以愉快的上网了！！可以 ssh 到服务器试一下 wget google.com，正常结果如下：\n❯ wget google.com --2021-09-13 18:11:04-- http://google.com/ Resolving google.com (google.com)... 93.46.8.90 Connecting to google.com (google.com)|93.46.8.90|:80... connected. HTTP request sent, awaiting response... 301 Moved Permanently Location: http://www.google.com/ [following] --2021-09-13 18:11:05-- http://www.google.com/ Resolving www.google.com (www.google.com)... 108.160.165.141, 2001::453f:b213 Connecting to www.google.com (www.google.com)|108.160.165.141|:80... connected. HTTP request sent, awaiting response... 200 OK Length: unspecified [text/html] Saving to: ‘index.html’ index.html [ \u003c=\u003e ] 13.42K 59.8KB/s in 0.2s 2021-09-13 18:11:06 (59.8 KB/s) - ‘index.html’ saved [13740] 这代表着，我们下载到了 google.com 页面的源码，即可以连通 Google 服务。\n一些存在的小问题 我现在还没有搞清楚透明代理的作用，如果不开的话，我通过 proxychains 配置对应的端口，发现并不能上网，但是如果我直接开了透明代理，不需要 proxychains 也可以直接在终端使用代理，感觉是全局代理，不过不影响使用。\n具体的一些细节还没有搞清楚，后续学习了再回来补更。\n","wordCount":"315","inLanguage":"en","datePublished":"2021-09-13T18:15:00Z","dateModified":"2021-09-13T18:15:00Z","author":{"@type":"Person","name":"zzsqwq"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.zzsqwq.cn/posts/212/"},"publisher":{"@type":"Organization","name":"Zs's Blog","logo":{"@type":"ImageObject","url":"https://blog.zzsqwq.cn/images/avatar.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.zzsqwq.cn accesskey=h title="Zs's Blog (Alt + H)">Zs's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://blog.zzsqwq.cn/about title=About><span>About</span></a></li><li><a href=https://blog.zzsqwq.cn/posts title=Posts><span>Posts</span></a></li><li><a href=https://blog.zzsqwq.cn/friends title=Friends><span>Friends</span></a></li><li><a href=https://blog.zzsqwq.cn/contact title=Contact><span>Contact</span></a></li><li><a href=https://blog.zzsqwq.cn/search title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.zzsqwq.cn>Home</a>&nbsp;»&nbsp;<a href=https://blog.zzsqwq.cn/posts/>Posts</a></div><h1 class=post-title>纯终端环境代理配置教程</h1><div class=post-meta><span title='2021-09-13 18:15:00 +0000 UTC'>September 13, 2021</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;zzsqwq&nbsp;|&nbsp;<a href=https://github.com/zzsqwq/zzsqwq.github.io/tree/master/content/posts/%e7%ba%af%e7%bb%88%e7%ab%af%e7%8e%af%e5%a2%83%e4%bb%a3%e7%90%86%e9%85%8d%e7%bd%ae%e6%95%99%e7%a8%8b.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e7%ba%af%e7%bb%88%e7%ab%af%e7%8e%af%e5%a2%83%e4%bb%a3%e7%90%86%e9%85%8d%e7%bd%ae%e6%95%99%e7%a8%8b aria-label=纯终端环境代理配置教程>纯终端环境代理配置教程</a><ul><li><a href=#%e5%89%8d%e8%a8%80 aria-label=前言>前言</a></li><li><a href=#%e6%95%99%e7%a8%8b aria-label=教程>教程</a><ul><li><a href=#%e4%b8%80%e5%ae%89%e8%a3%85-v2ray-core aria-label="一、安装 v2ray-core">一、安装 v2ray-core</a><ul><li><a href=#%e4%b8%8b%e8%bd%bd-fhs-install-v2ray-%e6%ba%90%e7%a0%81 aria-label="下载 fhs-install-v2ray 源码">下载 fhs-install-v2ray 源码</a></li><li><a href=#%e5%b0%86%e6%ba%90%e7%a0%81%e4%b8%8a%e4%bc%a0%e5%88%b0%e8%bf%9c%e7%ab%af aria-label=将源码上传到远端>将源码上传到远端</a></li><li><a href=#%e4%b8%8b%e8%bd%bd-v2ray-core-%e6%ba%90%e7%a0%81 aria-label="下载 v2ray-core 源码">下载 v2ray-core 源码</a></li><li><a href=#%e8%bf%9e%e6%8e%a5%e8%bf%9c%e7%a8%8b%e6%9c%8d%e5%8a%a1%e5%99%a8 aria-label=连接远程服务器>连接远程服务器</a></li><li><a href=#%e5%ae%8c%e6%88%90%e5%ae%89%e8%a3%85 aria-label=完成安装>完成安装</a></li></ul></li><li><a href=#%e4%ba%8c%e5%ae%89%e8%a3%85-v2raya aria-label="二、安装 v2rayA">二、安装 v2rayA</a></li><li><a href=#%e4%b8%80%e4%ba%9b%e5%ad%98%e5%9c%a8%e7%9a%84%e5%b0%8f%e9%97%ae%e9%a2%98 aria-label=一些存在的小问题>一些存在的小问题</a></li></ul></li></ul></li></ul></div></details></div><div class=post-content><h1 id=纯终端环境代理配置教程>纯终端环境代理配置教程<a hidden class=anchor aria-hidden=true href=#纯终端环境代理配置教程>#</a></h1><h2 id=前言>前言<a hidden class=anchor aria-hidden=true href=#前言>#</a></h2><p>我们在很多情况下，可能会在云服务器或是其他纯终端环境（例如树莓派服务器等），或者一些没有屏幕的情况下，只能 <strong>ssh</strong> 链接到服务器上进行一些操作。</p><p>这些时候，如果我们想要克隆一个 Github 的仓库，或者下载一些镜像源中没有的文件，简直是难如登天，100kb/s 的速度都很罕见，因此在这种环境下配一个代理还是十分必要的！</p><p>我们常在 Linux 上使用的 GUI 代理软件如 <strong>Qv2ray、Clash</strong> 这些就没法用了。因此需要考虑如何在纯终端环境中配置代理的问题，这篇教程就是为解决此问题而写的。</p><h2 id=教程>教程<a hidden class=anchor aria-hidden=true href=#教程>#</a></h2><p>此教程搭配的是常用的 <strong>v2ray-core + v2rayA</strong> ，这里的 <strong>v2rayA</strong> 是一个网页端的代理管理工具，其中支持 <strong>v2ray、Xray、SS、SSR、Trojan</strong> 等多种协议。</p><h3 id=一安装-v2ray-core>一、安装 v2ray-core<a hidden class=anchor aria-hidden=true href=#一安装-v2ray-core>#</a></h3><p>首先是需要安装 <strong>v2ray-core</strong> ，这里我们使用开源的项目 <a href=https://github.com/v2fly/fhs-install-v2ray>v2fly/fhs-install-v2ray</a> 进行安装，它是一个脚本，可以直接运行完成 <strong>v2ray</strong> 的安装，安装的文件组织结构符合 <a href=https://en.wikipedia.org/wiki/Filesystem_Hierarchy_Standard>Filesystem Hierarchy Standard</a> ，十分方便简洁，很赞！</p><p>具体步骤如下：</p><h4 id=下载-fhs-install-v2ray-源码>下载 fhs-install-v2ray 源码<a hidden class=anchor aria-hidden=true href=#下载-fhs-install-v2ray-源码>#</a></h4><p>首先我们因为 Github 克隆很慢，可以先在自己的主机上克隆或者以 <strong>zip</strong> 包形式下载源码</p><h4 id=将源码上传到远端>将源码上传到远端<a hidden class=anchor aria-hidden=true href=#将源码上传到远端>#</a></h4><p>键入下列代码，通过 <code>scp</code> 将解压后的代码文件夹目录上传到远端服务器的根目录（如果是树莓派的话可以连接同一局域网进行），注意这里的 <strong>path/to/fhs-install-v2ray</strong> 指的是本地文件夹的路径</p><p><code>scp -r path/to/fhs-install-v2ray username@hostname:~</code></p><h4 id=下载-v2ray-core-源码>下载 v2ray-core 源码<a hidden class=anchor aria-hidden=true href=#下载-v2ray-core-源码>#</a></h4><p>此脚本可以全自动安装，即自动检测本机类型是 Ubuntu 还是其他的版本，然后从远端仓库下载最新的 <strong>v2ray</strong> 进行安装，不过因为没有代理，这一步还是十分缓慢，因此我们可以进行本地安装。</p><p>首先，我们去到 <strong>v2ray-core</strong> 的官方仓库的发布站 -> <a href=https://github.com/v2fly/v2ray-core/releases>Releases · v2fly/v2ray-core </a>，在这里可以下载最新版本的的 <strong>v2ray-core</strong>，不过需要注意的是，需要自己辨别版本，如使用的是 <strong>arm</strong> 还是 <strong>x64_86</strong> 等，下载后是一个 <strong>zip</strong> 压缩包，我们直接通过 <code>scp</code> 上传到远端服务器根目录</p><p><code>scp path/to/v2ray-linux-64.zip username@hostname:~</code></p><h4 id=连接远程服务器>连接远程服务器<a hidden class=anchor aria-hidden=true href=#连接远程服务器>#</a></h4><p>接下来我们通过 <strong>ssh</strong> 连接到远程服务器</p><p><code>ssh username@hostname</code></p><h4 id=完成安装>完成安装<a hidden class=anchor aria-hidden=true href=#完成安装>#</a></h4><p>然后进入根目录后，进入 <code>fhs-install-v2ray</code> 文件夹，会发现里面有两个脚本，一个是 <code>install-dat-release.sh</code> 另一个是 <code>install-release.sh</code> ，前者是带有路由规则的，后者是不带有路由规则的。我试用后发现 <code>install-dat-release.sh</code> 没有办法本地安装，而后者可以，同时因为 <strong>v2rayA</strong> 中会自带路由规则，因此完全没有必要用前者，我们可以直接使用 <code>install-release.sh</code> 进行安装。</p><p>执行 <code>sudo chmod +x install-release.sh</code> ，添加执行权限</p><p>执行 <code>sudo ./install-release.sh --local ../v2ray-linux-64.zip</code></p><p>这里的 local 参数代表是本地安装，解析后面的文件，<strong>注意这里是直接 zip 包</strong>，不需要解压。同时，这里的路径也是需要和你的下载的文件地址对应。</p><p>不出意外的话，瞬间就可以安装完成。截止到这里，<strong>v2ray-core</strong> 已经安装成功。需要注意的是，这里不需要执行 <code>sudo systemctl enable v2ray</code> ，因为后续的 <strong>v2rayA</strong> 不依赖此服务。</p><p>安装的文件路径如下：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>installed: /usr/local/bin/v2ray             <span class=c1>#v2ray 主程序地址</span>
</span></span><span class=line><span class=cl>installed: /usr/local/bin/v2ctl				<span class=c1>#v2ray 控制程序</span>
</span></span><span class=line><span class=cl>installed: /usr/local/share/v2ray/geoip.dat <span class=c1># 可选，路由信息</span>
</span></span><span class=line><span class=cl>installed: /usr/local/share/v2ray/geosite.dat <span class=c1>#可选，路由信息</span>
</span></span><span class=line><span class=cl>installed: /usr/local/etc/v2ray/config.json <span class=c1>#代理配置文件</span>
</span></span><span class=line><span class=cl>installed: /var/log/v2ray/					<span class=c1>#下面三个都是log文件</span>
</span></span><span class=line><span class=cl>installed: /var/log/v2ray/access.log
</span></span><span class=line><span class=cl>installed: /var/log/v2ray/error.log
</span></span><span class=line><span class=cl>installed: /etc/systemd/system/v2ray.service <span class=c1>#v2ray 服务配置信息</span>
</span></span><span class=line><span class=cl>installed: /etc/systemd/system/v2ray@.service
</span></span></code></pre></div><p>如果有报错的话，可以看对应的 <code>error</code> 报错去 <a href=https://github.com/v2fly/fhs-install-v2ray>v2fly/fhs-install-v2ray</a> 官方仓库 Issue 处查看。</p><h3 id=二安装-v2raya>二、安装 v2rayA<a hidden class=anchor aria-hidden=true href=#二安装-v2raya>#</a></h3><p>首先，同样的是，为了防止 Github 下载太慢，我们也可以去到官方仓库的发布站 -> <a href=https://github.com/v2rayA/v2rayA/releases>Releases · v2rayA/v2rayA</a> ，下载对应系统版本的安装包，然后通过 <code>scp</code> 上传到远端。</p><p>这里以 <strong>x64_86 版本的 Ubuntu 18.04.5 LTS</strong> 举例，我们直接下载 <code>installer_debian_x64_v1.5.2.deb</code> 到本地，然后执行</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>scp path/to/installer_debian_x64_v1.5.2.deb username@hostname:~
</span></span></code></pre></div><p>将文件上传到远端。</p><p>然后 <strong>ssh</strong> 到服务器执行：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>sudo dpkg -i installer_debian_x64_v1.5.2.deb
</span></span></code></pre></div><p>安装成功后依次执行：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># 启动 v2raya</span>
</span></span><span class=line><span class=cl>sudo systemctl start v2raya
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 开机自启 v2raya</span>
</span></span><span class=line><span class=cl>sudo systemctl <span class=nb>enable</span> v2raya
</span></span></code></pre></div><p>这样就成功开启了 <code>v2rayA</code>，我们访问 <code>ip:2017</code> ，前面是你云服务器的公网 <code>ip</code> 或者是自建服务器的局域网 <code>ip</code> ，我们就可以访问到对应的服务，界面大致如下：</p><p><img loading=lazy src=https://blog.zzsqwq.cn/usr/uploads/2021/09/2395630589.png alt=v2rayA界面></p><p>首次进入时会让你设置账号和密码，用于后续的管理。还会引导你导入链接，在导入链接后，就可以点击上方的第三栏，进行连接、查看或分享对应的代理了！</p><p>说一下我现在用的设置，点击右上角设置，<strong>透明代理和规则端口的分流模式</strong>设置为<strong>大陆白名单</strong>，然后实现方式我用的是 <strong>redirect</strong>，每隔 24h 更新依次代理，左下角设置的地址与端口我用的是默认的，如下：</p><p><img loading=lazy src=https://blog.zzsqwq.cn/usr/uploads/2021/09/2537498828.png alt=地址与端口设置></p><p>这样我们就可以愉快的上网了！！可以 <strong>ssh</strong> 到服务器试一下 <code>wget google.com</code>，正常结果如下：</p><pre tabindex=0><code>❯ wget google.com
--2021-09-13 18:11:04--  http://google.com/
Resolving google.com (google.com)... 93.46.8.90
Connecting to google.com (google.com)|93.46.8.90|:80... connected.
HTTP request sent, awaiting response... 301 Moved Permanently
Location: http://www.google.com/ [following]
--2021-09-13 18:11:05--  http://www.google.com/
Resolving www.google.com (www.google.com)... 108.160.165.141, 2001::453f:b213
Connecting to www.google.com (www.google.com)|108.160.165.141|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: unspecified [text/html]
Saving to: ‘index.html’

index.html                        [  &lt;=&gt;                                             ]  13.42K  59.8KB/s    in 0.2s

2021-09-13 18:11:06 (59.8 KB/s) - ‘index.html’ saved [13740]
</code></pre><p>这代表着，我们下载到了 <strong>google.com</strong> 页面的源码，即可以连通 <strong>Google</strong> 服务。</p><h3 id=一些存在的小问题>一些存在的小问题<a hidden class=anchor aria-hidden=true href=#一些存在的小问题>#</a></h3><p>我现在还没有搞清楚透明代理的作用，如果不开的话，我通过 <code>proxychains</code> 配置对应的端口，发现并不能上网，但是如果我直接开了透明代理，不需要 <code>proxychains</code> 也可以直接在终端使用代理，感觉是全局代理，不过不影响使用。</p><p>具体的一些细节还没有搞清楚，后续学习了再回来补更。</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.zzsqwq.cn/tags/linux/>Linux</a></li><li><a href=https://blog.zzsqwq.cn/tags/v2ray/>v2ray</a></li><li><a href=https://blog.zzsqwq.cn/tags/%E4%BB%A3%E7%90%86/>代理</a></li></ul><nav class=paginav><a class=prev href=https://blog.zzsqwq.cn/posts/215/><span class=title>« Prev</span><br><span>2021版小新Pro14 Ubuntu 20.04 配置指南</span></a>
<a class=next href=https://blog.zzsqwq.cn/posts/209/><span class=title>Next »</span><br><span>Redmi AC2100刷写OpenWrt教程</span></a></nav></footer><div class=comments><script>let getTheme=window.localStorage&&window.localStorage.getItem("colorscheme");getTheme=getTheme??"preferred_color_scheme";let s=document.createElement("script");s.src="https://giscus.app/client.js",s.setAttribute("data-repo","zzsqwq/hugo-blog-comment"),s.setAttribute("data-repo-id","R_kgDOGgU1qQ"),s.setAttribute("data-category","Announcements"),s.setAttribute("data-category-id","DIC_kwDOGgU1qc4CSX1m"),s.setAttribute("data-mapping","pathname"),s.setAttribute("data-strict","0"),s.setAttribute("data-reactions-enabled","1"),s.setAttribute("data-emit-metadata","0"),s.setAttribute("data-input-position","top"),s.setAttribute("data-theme",getTheme),s.setAttribute("data-lang",""),s.setAttribute("crossorigin","anonymous"),s.setAttribute("async",""),document.querySelector("div.comments").innerHTML="",document.querySelector("div.comments").appendChild(s)</script></div></article></main><footer class=footer><span>&copy; 2023 <a href=https://blog.zzsqwq.cn>Zs's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>